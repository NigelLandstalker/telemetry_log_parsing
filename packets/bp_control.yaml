packets:
  - name: bp_state
    description: Low frequency BP status update.
    id: 0x200
    endian: little
    data:
      - name: battery_voltage
        type: uint16_t
        units: V
        conversion: 0.01
      - name: aux_voltage
        type: uint16_t
        units: V
        conversion: 0.001
      - name: primary_voltage
        type: uint16_t
        conversion: 0.001
        units: V
      - name: status
        type: bitfield
        bits:
          - name: contactor_tracker_pre
          - name: contactor_bus
          - name: contactor_bus_pre
          - name: contactor_tracker
          - name: power_is_primary
          - name: primary_power_enabled
          - name: aux_charge_enabled
          - name: car_allowed_on
          
  - name: bp_soc
    description: State of charge
    id: 0x201
    endian: little
    data:
      - name: soc
        type: float
        conversion: 1
      - name: Ah
        type: float
        conversion: 1
  - name: bp_soc_set
    description: write state of charge, use with caution
    id: 0x211
    endian: little
    data:
      - name: Ah
        type: float
        conversion: 1
  - name: bp_current
    description: current draw out of the battery
    id: 0x202
    endian: little
    data:
      - name: main
        type: float
        units: A
        conversion: 1
      - name: tracker
        type: float
        units: A
        conversion: 1
  - name: bp_minmax
    description: min and max cell voltages and temperatures
    id: 0x203
    endian: little
    data:
      - name: max_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: min_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: max_cell
        type: uint16_t
        units: V
        conversion: 0.001
      - name: min_cell
        type: uint16_t
        units: V
        conversion: 0.001
  - name: bp_startup_error
    description: Information for car startup problems.
    id: 0x204
    endian: little
    data:
      - name: data1
        type: uint16_t
      - name: data2
        type: uint16_t
      - name: error_code1
        type: bitfield
        bits:
          - name: KILL_REASON_OVERVOLT
          - name: KILL_REASON_UNDERVOLT
          - name: KILL_REASON_OVERTEMP
          - name: KILL_REASON_MODULE_COMM_FAIL
          - name: KILL_REASON_OVERCURRENT
          - name: KILL_REASON_PRECHARGE_FAIL
          - name: KILL_REASON_PRIMARY_POWER_FAIL

  - name: bp_discharge
    description: reports discharge parameters
    id: 0x205
    endian: little
    data:
      - name: target_voltage
        type: uint16_t
        units: V
        conversion: .001
      - name: discharge_rate
        type: uint8_t
        units: "%"
      - name: flags
        type: bitfield
        bits:
          - name: discharge_enable
  - name: bp_discharge_set
    description: sets discharge parameters
    id: 0x215
    endian: little
    data:
      - name: target_voltage
        type: uint16_t
        units: V
        conversion: .001
      - name: discharge_rate
        type: uint8_t
        units: "%"
      - name: flags
        type: bitfield
        bits:
          - name: discharge_enable
  - name: bp_temp
    id: 0x206
    endian: little
    description: reports BP params for temperature
    data:
      - name: charge_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: discharge_temp
        type: int16_t
        units: C
        conversion: 0.01
  - name: bp_temp_set
    id: 0x216
    endian: little
    description: sets BP params for temperature
    data:
      - name: check
        type: uint32_t
      - name: charge_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: discharge_temp
        type: int16_t
        units: C
        conversion: 0.01
  - name: bp_volt
    id: 0x207
    endian: little
    description: reports BP params for voltage
    data:
      - name: voltage_max
        type: uint16_t
        units: V
        conversion: 0.001
      - name: voltage_min
        type: uint16_t
        units: V
        conversion: 0.001
  - name: bp_volt_set
    id: 0x217
    endian: little
    description: sets BP params for voltage
    data:
      - name: check
        type: uint32_t
      - name: voltage_max
        type: uint16_t
        units: V
        conversion: 0.001
      - name: voltage_min
        type: uint16_t
        units: V
        conversion: 0.001
  - name: bp_currentlimit
    id: 0x208
    endian: little
    description: reports BP params for current
    data:
      - name: current_max
        type: int16_t
        units: A
        conversion: 0.01
      - name: current_min
        type: int16_t
        units: A
        conversion: 0.01
  - name: bp_fan_info
    description: BP Fans
    id: 0x209
    endian: little
    data:
      - name: fan1
        type: uint16_t
        units: RPM
        conversion: 1
      - name: fan2
        type: uint16_t
        units: RPM
        conversion: 1
      - name: fan3
        type: uint16_t
        units: RPM
        conversion: 1
      - name: fan4
        type: uint16_t
        units: RPM
        conversion: 1
  - name: bp_local_temperature
    description: Locally measured temperatures
    id: 0x20a
    endian: little
    data:
      - name: ambient_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: vicor_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: aux_pack_temp
        type: int16_t
        units: C
        conversion: 0.01
      - name: precharge_resistor_temp
        type: int16_t
        units: C
        conversion: 0.01
  - name: bp_light_rh_current
    description: BP light sensor, relitive humidity, and locally meausred currents
    id: 0x20b
    endian: little
    data:
      - name: light_intensity
        type: uint16_t
        uints: ???
        conversion: 1
      - name: relitive_humidity
        type: uint16_t
        units: '%'
        conversion: 0.01
      - name: active_balance_current
        type: int16_t
        units: A
        conversion: 0.001
      - name: primary_power_current
        type: int16_t
        units: A
        conversion: 0.001
  - name: bp_hv_nodes
    description: High voltage node voltages
    id: 0x20c
    endian: little
    data:
      - name: vbat_pp
        type: uint8_t
        units: V
        conversion: 1
      - name: vbat_bal
        type: uint8_t
        units: V
        conversion: 1
      - name: vbat_bus
        type: uint8_t
        units: V
        conversion: 1
      - name: vbat_pre_rly
        type: uint8_t
        units: V
        conversion: 1
      - name: vbat_pre_bus
        type: uint8_t
        units: V
        conversion: 1
      - name: vary_pre_rly
        type: uint8_t
        units: V
        conversion: 1
      - name: vary_pre_bus
        type: uint8_t
        units: V
        conversion: 1
  - name: bp_warning
    description: Warnings that do not shut off the car
    id: 0x20d
    endian: little
    data:
      - name: general
        type: bitfield
        bits:
          - name: battery_lid_open
          - name: rtc_battery_dead
      - name: fuses
        type: bitfield
        bits:
          - name: balance_fuse_blown
          - name: vicor_input_fuse_blown
      - name: temperatures
        type: bitfield
        bits:
          - name: microcontroller_overtemp
          - name: vicor_overtemp
          - name: aux_pack_overtemp
          - name: precharge_resistor_overtemp
          - name: vicor_thermistor_unplugged
          - name: aux_pack_thermistor_unplugged
          - name: precharge_resistor_thermistor_unplugged
  - name: bp_rtc
    description: Value of the real time clock in nanoseconds
    id: 0x20e
    endian: little
    data:
      - name: unix_time_nanoseconds
        type: uint64_t
        units: ns
  - name: bp_rtc_set
    description: Sets the value of the real time clock in nanoseconds
    id: 0x20f
    endian: little
    data:
      - name: unix_time_nanoseconds
        type: uint64_t
        units: ns
        
  - name: bp_currentlimit_set
    id: 0x218
    endian: little
    description: sets BP params for current
    data:
      - name: check
        type: uint32_t
      - name: current_max
        type: int16_t
        units: A
        conversion: 0.01
      - name: current_min
        type: int16_t
        units: A
        conversion: 0.01
  - name: bp_module
    description: &bp_module_desc Voltage and temperature for a single module
    id: 0x220
    endian: little
    repeat: 36
    offset: 1
    data: &bp_module_data 
      - name: voltage
        type: uint16_t
        units: V
        conversion: 0.001
      - name: temperature
        type: int16_t
        units: C
        conversion: 0.01
      - name: discharge
        type: uint8_t
        units: "%"
        conversion: 1
  - name: bp_stack_voltages
    description: info about a single LTC6804 chip
    id: 0x250
    endian: little
    repeat: 3
    offset: 1
    data:
      - name: sum_of_cells
        type: uint16_t
        units: V
        conversion: 0.001
      - name: vref
        type: uint16_t
        units: V
        conversion: 0.001
      - name: vdd
        type: uint16_t
        units: V
        conversion: 0.001
      - name: avdd
        type: uint16_t
        units: V
        conversion: 0.001
  - name: bp_stack_temperatures
    description: temperature measurements for each stack
    id: 0x260
    endian: little
    repeat: 3
    offset: 1
    data:
      - name: die_temp
        type: int16_t
        units: V
        conversion: 0.01
      - name: aux_temperature_1
        type: int16_t
        units: C
        conversion: 0.01
      - name: aux_temperature_2
        type: int16_t
        units: C
        conversion: 0.01